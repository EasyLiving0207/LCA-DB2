CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_SEQ_CALC_MONTH(
        'TM',
        '202502',
        '202502',
        '2025',
        'T_ADS_FACT_LCA_MAIN_CAT_ENERGY_RESULT',
        'MX202503',
        'T_ADS_FACT_LCA_BGMG_CR0001_2024_NEW',
        'MX202503TEST',
        'T_ADS_FACT_LCA_SUBCLASS_MONTH_RESULT'
     );

CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_SEQ_CALC_MONTH(
        'TM',
        NULL,
        '202501',
        '2025',
        'T_ADS_FACT_LCA_MAIN_CAT_ENERGY_RESULT',
        'MX202503',
        'T_ADS_FACT_LCA_BGMG_CR0001_2024_NEW',
        'MX202503',
        'T_ADS_FACT_LCA_SUBCLASS_MONTH_RESULT'
     );

CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_SEQ_CALC_MONTH(
        'TM',
        NULL,
        NULL,
        '2025',
        'T_ADS_FACT_LCA_MAIN_CAT_ENERGY_RESULT',
        'MX202503',
        'T_ADS_FACT_LCA_BGMG_CR0001_2024_TEST',
        'T_ADS_FACT_LCA_SUBCLASS_MONTH_RESULT'
     );

CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_SEQ_CALC_MONTH(
        'TM',
        NULL,
        NULL,
        '2025',
        'T_ADS_FACT_LCA_MAIN_CAT_ENERGY_RESULT',
        'MX202503',
        'T_ADS_FACT_LCA_BGMG_CR0001_2024TEST',
        'T_ADS_FACT_LCA_SUBCLASS_MONTH_RESULT'
     );




-- 202501 17:16.715
-- 202502 14:26.228
-- 202503 29:45.436
-- 202504 17:11.133
-- 202505 18:55.325
-- 836898

-- 2:15

-- TM
CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_EPD_NORM_CALC_MONTH(
        'TM',
        NULL,
        NULL,
        '2025',
        'T_ADS_FACT_LCA_MAIN_CAT_EPD_NORM_RESULT',
        'MX202503',
        'T_ADS_FACT_LCA_BGMG_CR0001_2024_TEST',
        'T_ADS_FACT_LCA_SUBCLASS_EPD_NORM_MONTH_RESULT'
     );

-- BSZG
CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_EPD_CONS_CALC_MONTH(
        'BSZG',
        NULL,
        NULL,
        '2025',
        'SimaPro_Ecoinvent3.11',
        'T_ADS_FACT_LCA_MAIN_CAT_EPD_CONS_RESULT',
        '20240120241220250814YS_CONS',
        'T_ADS_FACT_LCA_BGZG_HP0001_2024_NEW',
        'T_ADS_FACT_LCA_SUBCLASS_EPD_CONS_MONTH_RESULT_BSZG_HP0001',
        18
     );

CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_EPD_CONS_CALC_BUFF_MONTH(
        'BSZG',--基地代码
        '2025',--因子年份 默认2025
        'SimaPro_Ecoinvent3.11',--因子库版本 默认SimaPro_Ecoinvent3.11
        'T_ADS_FACT_LCA_MAIN_CAT_EPD_CONS_RESULT',--大类结果表
        '20240120241220250814YS_CONS',--大类结果批次号（批次号 + _CONS）
        'T_ADS_FACT_LCA_BGZG_HP0001_2024_NEW',--活动数据表
        'T_ADS_FACT_LCA_SUBCLASS_EPD_CONS_MONTH_RESULT_BSZG_HP0001_NEW'--结果表
     );

-- TA
CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_EPD_CONS_CALC_BUFF_MONTH(
        'TA',
        NULL,
        NULL,
        '2025',
        'EF3.1_Ecoinvent3.11',
        'T_ADS_FACT_LCA_MAIN_CAT_EPD_CONS_RESULT',
        '20240120241220250911YS_CONS',
        'T_ADS_FACT_LCA_HP0001_2024_TEST',--活动数据表
        'T_ADS_FACT_LCA_SUBCLASS_EPD_CONS_MONTH_RESULT_TA_HP0001'--结果表
     );

CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_EPD_CONS_CALC_MONTH(
        'TA',
        NULL,
        NULL,
        '2025',
        'SimaPro_Ecoinvent3.11',
        'T_ADS_FACT_LCA_MAIN_CAT_EPD_CONS_RESULT',
        '20240120241220250107YS_CONS',
        'T_ADS_FACT_LCA_HP0001_2024_TEST',
        'T_ADS_FACT_LCA_SUBCLASS_EPD_CONS_MONTH_RESULT_TA_HP0001',
        18
     );

CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_EPD_CONS_CALC_BUFF_MONTH(
        'TA',
        '2025',
        'SimaPro_Ecoinvent3.11',
        'T_ADS_FACT_LCA_MAIN_CAT_EPD_CONS_RESULT',
        '20240120241220250107YS_CONS',
        'T_ADS_FACT_LCA_HP0001_2024_TEST',
        'T_ADS_FACT_LCA_SUBCLASS_EPD_CONS_MONTH_RESULT_TA_HP0001'
     );

-- CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_EPD_CONS_CALC_MONTH_RESOURCE(
--         'TA',
--         NULL,
--         NULL,
--         '2025',
--         'T_ADS_FACT_LCA_MAIN_CAT_EPD_CONS_RESULT_VER2',
--         '20240120241220250107YS_CONS',
--         'T_ADS_FACT_LCA_HP0001_2024_TEST',
--         'T_ADS_FACT_LCA_SUBCLASS_EPD_CONS_MONTH_RESULT_TA_HP0001_RESOURCE'
--      );


-- CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_EPD_CONS_AUTH_CALC_MONTH(
--         'TA',
--         NULL,
--         NULL,
--         '2025',
--         'T_ADS_FACT_LCA_MAIN_CAT_EPD_CONS_RESULT',
--         '20240120241220250107YS_CONS',
--         'T_ADS_FACT_LCA_HP0001_2024_TEST',
--         'T_ADS_FACT_LCA_SUBCLASS_EPD_CONS_MONTH_RESULT_TA_HP0001'
--      );


select *
from T_ADS_FACT_LCA_MAIN_CAT_EPD_CONS_RESULT
where COMPANY_CODE = 'TA'
  and BATCH_NUMBER = '20240120241220250107YS_CONS';


truncate T_ADS_FACT_LCA_BGMG_CR0001_2024_TEST immediate;

update T_ADS_FACT_LCA_BGMG_CR0001_2024_TEST
set UPDATE_DATE = '202501';


CALL BG00MAC102.P_ADS_FACT_LCA_MAIN_CAT_EPD_NORM_CALC(
        'TM',
        '202503',
        '202503',
        'T_ADS_FACT_LCA_MAIN_CAT_EPD_NORM_RESULT',
        'T_ADS_FACT_LCA_MAIN_CAT_MATRIX_ENERGY',
        'MX202503',
        '2025'
     );


select *
from T_ADS_FACT_LCA_MAIN_CAT_EPD_NORM_RESULT
where BATCH_NUMBER = 'MX202503'
  and COMPANY_CODE = 'TM';



CALL BG00MAC102.P_ADS_FACT_LCA_SUBCLASS_SEQ_CALC_MONTH_SMF(
        'TM',
        NULL,
        NULL,
        '2025',
        'T_ADS_FACT_LCA_MAIN_CAT_ENERGY_RESULT',
        'MX202503',
        'T_ADS_FACT_LCA_BGMG_CR0001_2024_NEW',
        'MX202503TEST',
        'T_ADS_FACT_LCA_SUBCLASS_MONTH_RESULT'
     );

select * from T_ADS_WH_LCA_EPD_CONS_FACTOR_VERSION
where VERSION = 'EN15804_Ecoinvent3.11';


-- 202504:1953649,17m31s


